function cheResize(){$("#screenwide")[0].innerText=window.innerWidth,$("#content")[0].style.zoom=window.innerWidth<1150?window.innerWidth/1150-.01:1,window.innerWidth<1e3?$("#sorry").fadeIn():$("#sorry").fadeOut()}function playNextBeat(){if(isPlaying!==!1){$("#tracker li.pip").removeClass("active"),$("#tracker li.pip.col_"+curBeat).addClass("active");var e;$(".soundrow[id^=control] li.pip.active.col_"+curBeat).each(function(){e=document.getElementById($(this).data("sound_id")),e.paused||(e.pause(),e.currentTime=0),e.play()}),curBeat=(curBeat+1)%16}}function generateURLHash(){var e="";$(".soundrow[id^=control] li.pip").each(function(){e+=$(this).is(".active")?",":"."}),e+="|",e+=$("#temposlider").slider("value"),location.hash!="#"+e&&(location.hash=e)}function loadHash(){if(location.hash.length>0){var e=location.hash.substring(1).split("|"),i=e[0];$(".soundrow[id^=control] li.pip").each(function(e){return e>=i.length?!1:(","==i.charAt(e)?$(this).addClass("active"):$(this).removeClass("active"),void 0)}),"undefined"!=typeof e[1]&&($("#temposlider").slider("value",parseInt(e[1])),$("#tempovalue").innerHTML=e[1],curTempo=parseInt(e[1])),$("#tempovalue").html(curTempo),isPlaying!==!1&&(clearInterval(isPlaying),isPlaying=setInterval(playNextBeat,6e4/curTempo/4))}}function clearAll(){$(".soundrow[id^=control] li.active").removeClass("active"),generateURLHash()}function shareit(){console.log((new Date).getTime()),this.innerText="loading...",this.disabled=!0,prompt("Copy this URL and share with your friends!","http://akshatmittal.github.io/beatdrummer/"+location.hash),this.innerText="Share!",this.disabled=!1}function saveslot(e){localStorage["save"+e]=location.hash,checkslots()}function loadslot(e){void 0==localStorage["save"+e]?alert("This slot is empty!"):(location.hash=localStorage["save"+e],loadHash())}function checkslots(){for(i=1;4>i;i++)void 0!=localStorage["save"+i]?($("#slot"+i+".slotstatu")[0].innerText=i+". Saved",$("#loadslot"+i)[0].disabled=!1):($("#slot"+i+".slotstatu")[0].innerText=i+". empty",$("#loadslot"+i)[0].disabled=!0)}function clearslotsi(){localStorage.clear(),checkslots()}function loaddemo(e){var i=new Array("#,,..,,..,,..,,....................,................................,...,...,.......................................................,...,...,....,.............,,..........,...................,.,..............................,|80","#.,.,...,...,...,.......,.......,.................................................................................,....,.,..,.,.....,...,.,.....,...................,...,...,....................................................|120","#................,....,,.....,,,...,,....,,.........................................................,...,...,...,.................................................,...,...,...,,.................................................|120");location.hash=i[e-1],loadHash()}window.onresize=cheResize,cheResize();var isPlaying=!1,curBeat=0,curTempo=120,initTitle=document.title;$(document).ready(function(){$("audio").each(function(){var e=this,i=$('<ul id="control_'+this.id+'" class="soundrow">');for(i.append('<li class="header">'+this.title+"</li>"),j=0;16>j;j++){var t=$('<li class="pip col_'+j+'">'+e.id+"</li>").click(function(){$(this).toggleClass("active"),generateURLHash()}).data("sound_id",e.id);i.append(t)}$("<li>").append(i).appendTo("#lights")}),$("#soundstart").click(function(){isPlaying===!1?(curBeat=0,isPlaying=setInterval(playNextBeat,6e4/curTempo/4),this.innerHTML="Stop!",document.title="â™« "+initTitle):(clearInterval(isPlaying),isPlaying=!1,$("#tracker li.pip").removeClass("active"),$("audio").each(function(){this.pause(),this.currentTime=0}),this.innerHTML="Start!",document.title=initTitle)}),$("#clearall").click(clearAll),$("#reload").click(loadHash),$("#share").click(shareit),$("#crearslots").click(clearslotsi),""!=location.hash&&loadHash(),$("#tempovalue").html(curTempo),$("#temposlider").slider({value:curTempo,min:30,max:180,step:5,slide:function(e,i){curTempo=i.value,$("#tempovalue").html(curTempo),isPlaying!==!1&&(clearInterval(isPlaying),isPlaying=setInterval(playNextBeat,6e4/curTempo/4))},stop:function(){generateURLHash()}}),checkslots()});